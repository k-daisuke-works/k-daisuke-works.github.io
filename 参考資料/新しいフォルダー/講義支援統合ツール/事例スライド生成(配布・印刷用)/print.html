<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‹ä¾‹ A4å°åˆ·ç”¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f3f4f6;
            color: #111827;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* ----- Upload Screen ----- */
        #upload-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100vh;
            padding: 20px;
        }

        .upload-container {
            background: #fff;
            border: 2px dashed #9ca3af;
            border-radius: 20px;
            padding: 60px 40px;
            text-align: center;
            max-width: 600px;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .upload-container.dragover {
            background: #e0f2fe;
            border-color: #0284c7;
        }

        .upload-container h1 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #1f2937;
        }

        .upload-container p {
            color: #6b7280;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .file-upload-btn-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            margin-bottom: 20px;
        }

        .btn {
            background: #2563eb;
            color: #fff;
            padding: 12px 30px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #1d4ed8;
        }

        .upload-container textarea {
            width: 100%;
            height: 250px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 15px;
            color: #374151;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 20px;
            transition: border-color 0.3s ease;
        }

        .upload-container textarea:focus {
            outline: none;
            border-color: #2563eb;
        }

        .link-back {
            display: block;
            margin-top: 20px;
            color: #4b5563;
            text-decoration: underline;
            font-size: 0.9rem;
        }

        /* ----- Print Screen (A4 Layout) ----- */
        #print-screen {
            display: none;
            width: 100%;
            padding: 40px 20px;
            flex-direction: column;
            align-items: center;
        }

        .a4-page {
            background: #fff;
            width: 210mm;
            min-height: 297mm;
            /* Standard A4 height */
            padding: 20mm;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
        }

        .doc-title {
            font-size: 24pt;
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid #111827;
        }

        .section {
            margin-bottom: 25px;
        }

        .section h2 {
            font-size: 14pt;
            color: #1f2937;
            margin-bottom: 12px;
            padding-left: 10px;
            border-left: 5px solid #2563eb;
            background: #f3f4f6;
            padding: 5px 10px;
        }

        .section-content {
            font-size: 11pt;
            /* Readable standard document size */
            line-height: 1.7;
            color: #374151;
            white-space: pre-wrap;
            padding: 0 10px;
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 0 10px;
        }

        .tag {
            background: #dcfce7;
            color: #166534;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 11pt;
            border: 1px solid #bbf7d0;
        }

        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .controls button {
            background: #fff;
            border: 1px solid #d1d5db;
            color: #374151;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            font-weight: 500;
        }

        .controls button.primary {
            background: #2563eb;
            color: #fff;
            border: none;
        }

        .controls button:hover {
            opacity: 0.9;
        }

        /* Print Media Query */
        @media print {
            body {
                background: #fff !important;
            }

            #print-screen {
                padding: 0 !important;
            }

            .a4-page {
                width: 100% !important;
                min-height: auto !important;
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
            }

            .controls,
            #upload-screen,
            .link-back {
                display: none !important;
            }

            .section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>

<body>

    <!-- Upload Screen -->
    <div id="upload-screen">
        <div class="upload-container">
            <h1>ğŸ“„ å°åˆ·ç”¨ãƒ¬ãƒãƒ¼ãƒˆï¼ˆA4ç‰ˆï¼‰ã‚’ç”Ÿæˆ</h1>
            <p>äº‹ä¾‹ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€ç™½åœ°ã«é»’æ–‡å­—ã®<br>å°åˆ·ãƒ»è¨˜éŒ²ã«é©ã—ãŸA4ã‚µã‚¤ã‚ºã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚</p>
            <textarea id="text-input" placeholder="ã“ã“ã«äº‹ä¾‹ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„..."></textarea>
            <div class="file-upload-btn-container">
                <button class="btn" id="generate-btn">ç”Ÿæˆã™ã‚‹</button>
            </div>
            <a href="slide.html" class="link-back">â† ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ã€Œãƒ—ãƒ¬ã‚¼ãƒ³ç”¨å·¨å¤§ã‚¹ãƒ©ã‚¤ãƒ‰ã€ã«æˆ»ã‚‹</a>
        </div>
    </div>

    <!-- Print Screen -->
    <div id="print-screen">
        <div class="a4-page">
            <h1 class="doc-title" id="p-title"></h1>

            <div class="section">
                <h2>ğŸ“Œ ã‚±ãƒ¼ã‚¹æ¦‚è¦</h2>
                <div class="section-content" id="p-overview"></div>
            </div>

            <div class="section">
                <h2 style="border-left-color: #ef4444;">ğŸ—£ æœ¬äººã®ä¸»è¨´</h2>
                <div class="section-content" id="p-complaint"></div>
            </div>

            <div class="section">
                <h2 style="border-left-color: #8b5cf6;">ğŸ‘¥ ç™»å ´äººç‰©ãƒ»å®¶æ—æ§‹æˆ</h2>
                <div class="section-content" id="p-characters" style="margin-bottom: 10px;"></div>
                <div class="section-content" id="p-family"></div>
            </div>

            <div class="section">
                <h2 style="border-left-color: #f59e0b;">ğŸ©º èº«ä½“ãƒ»ç²¾ç¥çŠ¶æ³</h2>
                <div class="section-content" id="p-physical"></div>
            </div>

            <div class="section">
                <h2 style="border-left-color: #10b981;">ğŸ’° çµŒæ¸ˆãƒ»ç”Ÿæ´»åŸºç›¤</h2>
                <div class="section-content" id="p-economy"></div>
            </div>

            <div class="section">
                <h2 style="border-left-color: #059669;">âœ¨ æœ¬äººã®ã‚¹ãƒˆãƒ¬ãƒ³ã‚°ã‚¹</h2>
                <div class="tags" id="p-strengths"></div>
            </div>

            <div class="section">
                <h2 style="border-left-color: #6366f1;">ğŸ“– è±¡å¾´ã™ã‚‹å…·ä½“çš„ãªã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰</h2>
                <div class="section-content" id="p-episodes"></div>
            </div>
        </div>
    </div>

    <div class="controls" id="controls" style="display:none;">
        <button class="primary" onclick="window.print()">ğŸ–¨ï¸ A4ã§å°åˆ· (PDFä¿å­˜)</button>
        <button onclick="location.href='slide.html'">é»’èƒŒæ™¯ã®ã‚¹ãƒ©ã‚¤ãƒ‰ç‰ˆã¸æˆ»ã‚‹</button>
        <button onclick="location.reload()">â†º æ–°è¦ãƒ­ãƒ¼ãƒ‰</button>
    </div>

    <script>
        const generateBtn = document.getElementById('generate-btn');
        const textInput = document.getElementById('text-input');

        generateBtn.addEventListener('click', () => {
            const text = textInput.value;
            if (text.trim()) {
                parseAndRender(text);
            } else {
                alert("ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
            }
        });

        function parseAndRender(text) {
            const lines = text.split(/\r?\n/);
            const data = {
                title: 'äº‹ä¾‹ç ”ç©¶', overview: '', complaint: '', characters: '',
                physical: '', economy: '', family: '', strengths: [], episodes: ''
            };
            let currentSection = null;

            lines.forEach(line => {
                const textLine = line.trim();
                if (!textLine) {
                    if (currentSection && !['strengths'].includes(currentSection)) data[currentSection] += '\n';
                    return;
                }

                if (textLine.startsWith('ã€äº‹ä¾‹ï¼š') || textLine.startsWith('ã€äº‹ä¾‹ã‚¿ã‚¤ãƒˆãƒ«ï¼š')) { data.title = textLine.replace('ã€', '').replace('ã€‘', '').replace('äº‹ä¾‹ï¼š', '').replace('äº‹ä¾‹ã‚¿ã‚¤ãƒˆãƒ«ï¼š', ''); return; }

                if (textLine.includes('ãƒ»ã‚±ãƒ¼ã‚¹æ¦‚è¦') || textLine.includes('ã€ã‚±ãƒ¼ã‚¹æ¦‚è¦ã€‘')) { currentSection = 'overview'; return; }
                if (textLine.includes('ãƒ»æœ¬äººã®ä¸»è¨´') || textLine.includes('ã€æœ¬äººã®ä¸»è¨´ã€‘')) { currentSection = 'complaint'; return; }
                if (textLine.includes('ãƒ»ç™»å ´äººç‰©') || textLine.includes('ã€ç™»å ´äººç‰©ã€‘')) { currentSection = 'characters'; return; }
                if (textLine.includes('ãƒ»ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆè©³ç´°') || textLine.includes('ã€ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆè©³ç´°ã€‘')) { currentSection = null; return; }
                if (textLine.includes('ï¼‘ï¼èº«ä½“ãƒ»ç²¾ç¥çŠ¶æ³')) { currentSection = 'physical'; return; }
                if (textLine.includes('ï¼’ï¼çµŒæ¸ˆãƒ»ç”Ÿæ´»åŸºç›¤')) { currentSection = 'economy'; return; }
                if (textLine.includes('ï¼“ï¼å®¶æ—æ§‹æˆ')) { currentSection = 'family'; return; }
                if (textLine.includes('ï¼”ï¼æœ¬äººã®ã‚¹ãƒˆãƒ¬ãƒ³ã‚°ã‚¹')) { currentSection = 'strengths'; return; }
                if (textLine.includes('ï¼•ï¼æœ¬äººã‚’è±¡å¾´ã™ã‚‹')) { currentSection = 'episodes'; return; }

                if (currentSection === 'overview') data.overview += String(textLine) + '\n';
                else if (currentSection === 'complaint') data.complaint += String(textLine) + '\n';
                else if (currentSection === 'characters') data.characters += String(textLine) + '\n';
                else if (currentSection === 'physical') data.physical += String(textLine) + '\n';
                else if (currentSection === 'economy') data.economy += String(textLine) + '\n';
                else if (currentSection === 'family') data.family += String(textLine) + '\n';
                else if (currentSection === 'strengths') data.strengths.push(textLine);
                else if (currentSection === 'episodes') data.episodes += String(textLine) + '\n';
            });

            document.getElementById('p-title').innerText = data.title;
            document.getElementById('p-overview').innerText = data.overview.trim();
            document.getElementById('p-complaint').innerText = data.complaint.trim();
            document.getElementById('p-characters').innerText = data.characters.trim();
            document.getElementById('p-family').innerText = data.family.trim();
            document.getElementById('p-physical').innerText = data.physical.trim();
            document.getElementById('p-economy').innerText = data.economy.trim();
            document.getElementById('p-episodes').innerText = data.episodes.trim();

            const strengthsContainer = document.getElementById('p-strengths');
            strengthsContainer.innerHTML = '';
            data.strengths.forEach(s => {
                const t = document.createElement('span');
                t.className = 'tag'; t.innerText = s;
                strengthsContainer.appendChild(t);
            });

            document.getElementById('upload-screen').style.display = 'none';
            document.getElementById('print-screen').style.display = 'flex';
            document.getElementById('controls').style.display = 'flex';
        }
    </script>
</body>

</html>